<script src="https://cdn.jsdelivr.net/gh/titaniumtails/yesand@main/silktide-consent-manager.js"></script>
<script>
(function () {
  // Safe wrapper around gtag, if GA is not installed yet
  function safeGtag() {
    if (typeof window.gtag === 'function') {
      window.gtag.apply(null, arguments);
    } else {
      // Optional: comment this out in production if you don't want console noise
      console.log('gtag not available, skipped call:', arguments);
    }
  }

  // Safe wrapper around dataLayer.push, if GTM is not installed
  function safeDataLayerPush(obj) {
    if (Array.isArray(window.dataLayer)) {
      window.dataLayer.push(obj);
    } else {
      console.log('dataLayer not available, skipped push:', obj);
    }
  }

  silktideCookieBannerManager.updateCookieBannerConfig({
    background: {
      showBackground: true
    },
    cookieIcon: {
      position: "bottomRight"
    },
    cookieTypes: [
      {
        id: "necessary",
        name: "Necessary",
        description: "<p>These cookies are necessary for the website to function properly and cannot be switched off. They help with things like logging in and setting your privacy preferences.</p>",
        required: true,
        onAccept: function () {
          // Place any strictly necessary logic here (if needed)
          console.log('Necessary cookies accepted');
        }
      },
      {
        id: "analytics",
        name: "Analytics",
        description: "<p>These cookies help us improve the site by tracking which pages are most popular and how visitors move around the site.</p>",
        required: false,
        onAccept: function () {
          // Only runs if gtag or dataLayer exists
          safeGtag('consent', 'update', {
            analytics_storage: 'granted'
          });
          safeDataLayerPush({
            event: 'consent_accepted_analytics'
          });
          console.log('Analytics cookies accepted');
        },
        onReject: function () {
          safeGtag('consent', 'update', {
            analytics_storage: 'denied'
          });
          console.log('Analytics cookies rejected');
        }
      },
      {
        id: "advertising",
        name: "Advertising",
        description: "<p>These cookies provide extra features and personalization to improve your experience. They may be set by us or by partners whose services we use.</p>",
        required: false,
        onAccept: function () {
          // Later if using ad_storage with GA, update it here:
          safeGtag('consent', 'update', {
            ad_storage: 'granted'
          });
          safeDataLayerPush({
            event: 'consent_accepted_advertising'
          });
          console.log('Advertising cookies accepted');
        },
        onReject: function () {
          safeGtag('consent', 'update', {
            ad_storage: 'denied'
          });
          console.log('Advertising cookies rejected');
        }
      }
    ],
    text: {
      banner: {
        description: "<p>We use cookies on our site to enhance your user experience, provide personalized content, and analyze our traffic. <a href=\"/privacy-policy\" target=\"_blank\">Privacy Policy.</a></p>",
        acceptAllButtonText: "Accept all",
        acceptAllButtonAccessibleLabel: "Accept all cookies",
        rejectNonEssentialButtonText: "Reject non-essential",
        rejectNonEssentialButtonAccessibleLabel: "Reject non-essential",
        preferencesButtonText: "Preferences",
        preferencesButtonAccessibleLabel: "Toggle preferences"
      },
      preferences: {
        title: "Customize your cookie preferences",
        description: "<p>We respect your right to privacy. You can choose not to allow some types of cookies. Your cookie preferences will apply across our website.</p>",
      }
    },
    position: {
      banner: "bottomRight"
    }
  });
})();
</script>